{% extends "base.html" %}
{% block content %}
  <style>
    .layout{display:grid; grid-template-columns: 260px 1fr; gap:16px;}
    .sidebar{background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:12px;}
    .side-title{font-weight:700; margin:0 0 8px;}
    .side-links a{display:block; padding:8px 10px; border-radius:8px; text-decoration:none; color:#111827; border:1px solid #e5e7eb; margin-bottom:8px;}
    .side-links a.active{background:#2563eb; color:#fff; border-color:#2563eb;}
    .panel{background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:12px;}
    .grid-2{display:grid; grid-template-columns: repeat(2, minmax(220px,1fr)); gap:12px;}
    .grid-3{display:grid; grid-template-columns: repeat(3, minmax(180px,1fr)); gap:12px;}
    label{font-weight:600; font-size:14px;}
    input, select, textarea{width:100%; padding:8px; border:1px solid #e5e7eb; border-radius:8px;}
    textarea{min-height:90px;}
    .toolbar{display:flex; gap:10px; margin-top:12px;}
  </style>

  <div class="toolbar">
    <a class="btn" href="{{ url_for('registros') }}">Registros</a>
    <a class="btn" href="{{ url_for('dashboard') }}">Dashboard</a>
  </div>

  <div class="layout">
    <aside class="sidebar">
      <div class="side-title">Panel</div>
      <div class="side-links">
        <a href="{{ url_for('panel', tab='censo') }}" class="{{ 'active' if tab=='censo' }}">Censo</a>
        <a href="{{ url_for('panel', tab='eventos') }}" class="{{ 'active' if tab=='eventos' }}">Eventos de seguridad</a>
        <a href="{{ url_for('panel', tab='duplicidades') }}" class="{{ 'active' if tab=='duplicidades' }}">Duplicidades</a>
        <a href="{{ url_for('panel', tab='encuesta') }}" class="{{ 'active' if tab=='encuesta' }}">Encuesta de satisfacción</a>
        <a href="{{ url_for('panel', tab='atencion') }}" class="{{ 'active' if tab=='atencion' }}">Atención al público</a>
      </div>
    </aside>

    <section class="panel">
      {% if tab=='censo' %}
        <h2>Censo</h2>
        <form method="post" action="{{ url_for('panel', tab='censo') }}">
          <div class="grid-3">
            <div>
              <label>Fecha</label>
              <input type="date" name="fecha" required>
            </div>
            <div>
              <label>Censo día</label>
              <input type="number" name="censo_dia" min="0" placeholder="0">
            </div>
            <div>
              <label>Censo noche</label>
              <input type="number" name="censo_noche" min="0" placeholder="0">
            </div>
          </div>
          <div class="grid-3" style="margin-top:8px;">
            <div>
              <label>Total (opcional, si no se indica se calculará)</label>
              <input type="number" name="total" min="0" placeholder="(auto)">
            </div>
          </div>
          <div class="toolbar">
            <button class="btn" type="submit">Guardar</button>
          </div>
        </form>

      {% elif tab=='eventos' %}
        <h2>Eventos de seguridad</h2>
        <form method="post" action="{{ url_for('panel', tab='eventos') }}">
          <div class="grid-3">
            <div>
              <label>Fecha</label>
              <input type="date" name="fecha" required>
            </div>
            <div>
              <label>Horario</label>
              <input type="text" name="horario" placeholder="Mañana / Tarde / Noche o HH:MM" required>
            </div>
            <div>
              <label>Nombre del afectado</label>
              <input type="text" name="nombre_afectado" placeholder="Opcional">
            </div>
          </div>
          <div class="grid-2" style="margin-top:8px;">
            <div>
              <label>Qué ocurrió</label>
              <textarea name="que_ocurrio" required></textarea>
            </div>
            <div>
              <label>Acción</label>
              <textarea name="accion"></textarea>
            </div>
          </div>
          <div class="toolbar">
            <button class="btn" type="submit">Guardar</button>
          </div>
        </form>

      {% elif tab=='duplicidades' %}
        <h2>Duplicidades</h2>
        <form method="post" action="{{ url_for('panel', tab='duplicidades') }}">
          <div class="grid-3">
            <div>
              <label>Semana</label>
              <select name="semana" required>
                <option value="">-- Elegir --</option>
                {% for num, r in week_map.items()|sort %}
                  <option value="{{ num }}">{{ num }} ({{ r[0] }} → {{ r[1] }})</option>
                {% endfor %}
              </select>
            </div>
            <div>
              <label>Fecha</label>
              <input type="date" name="fecha" required>
            </div>
            <div>
              <label>ID</label>
              <input type="text" name="id">
            </div>
          </div>

          <div class="grid-3" style="margin-top:8px;">
            <div><label>Empresa contratista</label><input type="text" name="empresa_contratista"></div>
            <div><label>TIPO DE RIESGO (Psicosocial)</label><input type="text" name="tipo_riesgo"></div>
            <div><label>PABELLON</label><input type="text" name="pabellon"></div>
          </div>

          <div class="grid-3" style="margin-top:8px;">
            <div><label>Habitación</label><input type="text" name="habitacion"></div>
            <div><label>Ingresar Contacto</label><input type="text" name="ingresar_contacto"></div>
            <div><label>Nombre usuario</label><input type="text" name="nombre_usuario"></div>
          </div>

          <div class="grid-3" style="margin-top:8px;">
            <div><label>Responsable (Toma Requerimiento)</label><input type="text" name="responsable"></div>
            <div><label>Estatus (Cerrado o Abierto)</label><input type="text" name="estatus" placeholder="Abierto/Cerrado"></div>
            <div><label>Notificación Usuario</label><input type="text" name="notificacion_usuario"></div>
          </div>

          <div style="margin-top:8px;">
            <label>Descripción Problema</label>
            <textarea name="descripcion_problema"></textarea>
          </div>

          <div style="margin-top:8px;">
            <label>Plan de Acción</label>
            <textarea name="plan_accion"></textarea>
          </div>

          <div style="margin-top:8px;">
            <label>Fecha de Cierre</label>
            <input type="date" name="fecha_cierre">
          </div>

          <div class="toolbar">
            <button class="btn" type="submit">Guardar</button>
          </div>
        </form>

      {% elif tab=='encuesta' %}
        <h2>Encuesta de satisfacción</h2>
        <form method="post" action="{{ url_for('panel', tab='encuesta') }}">
          <div class="grid-3">
            <div>
              <label>FECHA_HORA</label>
              <input type="datetime-local" name="fecha_hora" required>
            </div>
          </div>
          <div class="grid-2" style="margin-top:8px;">
            <div><label>Q1_RESPUESTA</label><input type="text" name="q1_respuesta"></div>
            <div><label>Q1_PUNTAJE</label><input type="number" name="q1_puntaje" min="0" max="10"></div>
            <div><label>Q2_RESPUESTA</label><input type="text" name="q2_respuesta"></div>
            <div><label>Q2_PUNTAJE</label><input type="number" name="q2_puntaje" min="0" max="10"></div>
            <div><label>Q3_RESPUESTA</label><input type="text" name="q3_respuesta"></div>
            <div><label>Q3_PUNTAJE</label><input type="number" name="q3_puntaje" min="0" max="10"></div>
            <div><label>Q4_RESPUESTA</label><input type="text" name="q4_respuesta"></div>
            <div><label>Q4_PUNTAJE</label><input type="number" name="q4_puntaje" min="0" max="10"></div>
            <div><label>Q5_RESPUESTA</label><input type="text" name="q5_respuesta"></div>
            <div><label>Q5_PUNTAJE</label><input type="number" name="q5_puntaje" min="0" max="10"></div>
          </div>
          <div class="grid-2" style="margin-top:8px;">
            <div><label>COMENTARIOS</label><textarea name="comentarios"></textarea></div>
          </div>
          <div class="toolbar">
            <button class="btn" type="submit">Guardar</button>
          </div>
        </form>

      {% elif tab=='atencion' %}
        <h2>Atención al público</h2>
        <form method="post" action="{{ url_for('panel', tab='atencion') }}">
          <div class="grid-3">
            <div><label>FECHA</label><input type="date" name="fecha" required></div>
            <div><label>TIEMPO PROMEDIO (mm:ss)</label>
              <input type="text" name="tiempo_promedio" placeholder="mm:ss" pattern="[0-9]{2}:[0-9]{2}" title="mm:ss, ej: 03:54">
            </div>
            <div><label>CANTIDAD</label><input type="number" name="cantidad" min="0" placeholder="0"></div>
          </div>
          <div class="toolbar">
            <button class="btn" type="submit">Guardar</button>
          </div>
        </form>
      {% endif %}
    </section>
  </div>
{% endblock %}
